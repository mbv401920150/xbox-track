@page "/"

@using XboxTrack.Components

@inject PageIndexViewModel ViewModel

<CascadingValue TValue="PageIndexViewModel" Value="ViewModel">
    <PageTitle>Xbox Purchases</PageTitle>

    <MudOverlay @bind-Visible="ViewModel.IsLoading" DarkBackground="true" ZIndex="9999" AutoClose="true"/>
    <GridPurchase/>
</CascadingValue>

@code
{
    private void HandleViewModelChange() => StateHasChanged();
    
    protected override void OnInitialized()
    {
        ViewModel.OnChange += HandleViewModelChange;
    }

    public void Dispose()
    {
        ViewModel.OnChange -= HandleViewModelChange;
    }
}
